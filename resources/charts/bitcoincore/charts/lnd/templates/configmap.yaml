apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "lnd.fullname" . }}
  labels:
    {{- include "lnd.labels" . | nindent 4 }}
    role: macaroon-ref
data:
  lnd.conf: |
    color={{ include "namespace.color" . }}
    {{- .Values.baseConfig | nindent 4 }}
    {{- .Values.defaultConfig | nindent 4 }}
    {{- .Values.config | nindent 4 }}
    bitcoin.{{ .Values.global.chain }}=1
    bitcoind.rpcpass={{ .Values.global.rpcpassword }}
    bitcoind.rpchost={{ include "bitcoincore.fullname" . }}:{{ index .Values.global .Values.global.chain "RPCPort" }}
    bitcoind.zmqpubrawblock=tcp://{{ include "bitcoincore.fullname" . }}:{{ .Values.global.ZMQBlockPort }}
    bitcoind.zmqpubrawtx=tcp://{{ include "bitcoincore.fullname" . }}:{{ .Values.global.ZMQTxPort }}
    alias={{ include "lnd.fullname" . }}.{{ .Release.Namespace }}
    externalhosts={{ include "lnd.fullname" . }}
    tlsextradomain={{ include "lnd.fullname" . }}
  tls.cert: |
    -----BEGIN CERTIFICATE-----
    MIIB+DCCAZ6gAwIBAgIUSbyK/9viFWS3cLoPkmxZsW8fcH8wCgYIKoZIzj0EAwIw
    MjEfMB0GA1UECgwWbG5kIGF1dG9nZW5lcmF0ZWQgY2VydDEPMA0GA1UEAwwGd2Fy
    bmV0MB4XDTI1MDkwMzE1NDgzNFoXDTM1MDkwMTE1NDgzNFowMjEfMB0GA1UECgwW
    bG5kIGF1dG9nZW5lcmF0ZWQgY2VydDEPMA0GA1UEAwwGd2FybmV0MFkwEwYHKoZI
    zj0CAQYIKoZIzj0DAQcDQgAENIGvS4bQr/zzUQnIqgJIYrPEdPMXVkv3yEyJRCFg
    PyZTvxWUJy7AI3VKb7ubIXawYcnPBe7K1sgBAbTPz1c8sqOBkTCBjjAOBgNVHQ8B
    Af8EBAMCAqQwEwYDVR0lBAwwCgYIKwYBBQUHAwEwDwYDVR0TAQH/BAUwAwEB/zAd
    BgNVHQ4EFgQUNhDWW7rajlA9sNGI/1Q5BDLH/rMwNwYDVR0RBDAwLoIJbG9jYWxo
    b3N0ggkqLmRlZmF1bHSHBH8AAAGHEAAAAAAAAAAAAAAAAAAAAAEwCgYIKoZIzj0E
    AwIDSAAwRQIhAOFm85wvwPZMJg0+16Sh0FkKqAuGVmllHnriWHQJ1NhuAiAfoxzE
    9ooZuDwKy0Y3dP4DfJCrOlFNTHfp3abG7VQ+VQ==
    -----END CERTIFICATE-----

  tls.key: |
    -----BEGIN EC PRIVATE KEY-----
    MHcCAQEEIEKlsxGkakClpHqXbr6tqEey634Xc364DgGMJxLdiLHIoAoGCCqGSM49
    AwEHoUQDQgAENIGvS4bQr/zzUQnIqgJIYrPEdPMXVkv3yEyJRCFgPyZTvxWUJy7A
    I3VKb7ubIXawYcnPBe7K1sgBAbTPz1c8sg==
    -----END EC PRIVATE KEY-----

  MACAROON_HEX: {{ .Values.adminMacaroon }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "lnd.fullname" . }}-channels
  labels:
    channels: "true"
    {{- include "lnd.labels" . | nindent 4 }}
data:
  source: {{ include "lnd.fullname" . }}
  channels: |
    {{ .Values.channels | toJson }}
